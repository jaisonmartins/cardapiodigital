<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cardápio Digital SESC</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        font-family: "Poppins", sans-serif;
      }

      :root {
        --sesc-green: #4a9b8e;
        --sesc-green-dark: #2d5a54;
        --sesc-orange: #ff6b35;
        --sesc-orange-light: #ff8c65;
        --sesc-beige: #f4e7d1;
        --sesc-beige-light: #f9f1e6;
        --sesc-white: #ffffff;
        --shadow-color: rgba(74, 155, 142, 0.2);
      }

      body {
        background: linear-gradient(
          135deg,
          var(--sesc-green) 0%,
          var(--sesc-green-dark) 100%
        );
        background-attachment: fixed;
        min-height: 100vh;
        color: var(--sesc-white);
      }

      .sesc-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 25px 50px var(--shadow-color);
        border-radius: 2rem;
        color: var(--sesc-green-dark);
      }

      .sesc-glass {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(30px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 2rem;
      }

      .sesc-orange-bg {
        background: linear-gradient(
          135deg,
          var(--sesc-orange) 0%,
          var(--sesc-orange-light) 100%
        );
        color: white;
      }

      .sesc-green-bg {
        background: linear-gradient(
          135deg,
          var(--sesc-green) 0%,
          var(--sesc-green-dark) 100%
        );
        color: white;
      }

      .sesc-beige-bg {
        background: var(--sesc-beige);
        color: var(--sesc-green-dark);
      }

      .cardapio-title {
        font-size: 4rem;
        font-weight: 800;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: var(--sesc-orange);
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        margin-bottom: 0.5rem;
      }

      .do-dia-badge {
        background: var(--sesc-green-dark);
        color: white;
        padding: 0.5rem 2rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 1.5rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        display: inline-block;
        margin-bottom: 2rem;
      }

      .card-hover {
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        transform-style: preserve-3d;
      }

      .card-hover:hover {
        transform: translateY(-12px) scale(1.02);
        box-shadow: 0 35px 70px var(--shadow-color);
      }

      .fade-in {
        animation: fadeInUp 0.8s ease-out forwards;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .bounce-in {
        animation: bounceInScale 1s ease-out forwards;
      }

      @keyframes bounceInScale {
        0% {
          opacity: 0;
          transform: scale(0.3) rotate(-5deg);
        }
        50% {
          opacity: 1;
          transform: scale(1.05) rotate(2deg);
        }
        70% {
          transform: scale(0.95) rotate(-1deg);
        }
        100% {
          opacity: 1;
          transform: scale(1) rotate(0deg);
        }
      }

      .floating {
        animation: floating 3s ease-in-out infinite;
      }

      @keyframes floating {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .shimmer {
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        background-size: 200% 100%;
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      .pulse-glow {
        animation: pulseGlow 2s ease-in-out infinite alternate;
      }

      @keyframes pulseGlow {
        from {
          box-shadow: 0 0 20px var(--sesc-orange);
        }
        to {
          box-shadow: 0 0 40px var(--sesc-orange);
        }
      }

      .price-tag {
        background: linear-gradient(
          135deg,
          var(--sesc-orange) 0%,
          var(--sesc-orange-light) 100%
        );
        color: white;
        font-weight: 700;
        box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        border-radius: 1.5rem;
        padding: 0.75rem 1.5rem;
        font-size: 1.1rem;
      }

      .category-badge {
        background: linear-gradient(
          135deg,
          var(--sesc-green) 0%,
          var(--sesc-green-dark) 100%
        );
        color: white;
        box-shadow: 0 8px 25px var(--shadow-color);
        border-radius: 1.5rem;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
      }

      .loading-dots {
        display: inline-block;
      }

      .loading-dots::after {
        content: "";
        animation: loadingDots 1.5s infinite;
      }

      @keyframes loadingDots {
        0%,
        20% {
          content: "";
        }
        40% {
          content: ".";
        }
        60% {
          content: "..";
        }
        80%,
        100% {
          content: "...";
        }
      }

      .proteina-img {
        width: 100%;
        height: 300px;
        object-fit: cover;
        border-radius: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        border: 3px solid var(--sesc-orange);
        transition: all 0.4s ease;
      }

      .proteina-img:hover {
        transform: scale(1.02);
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        border-color: var(--sesc-orange-light);
      }

      .section-divider {
        height: 6px;
        background: linear-gradient(
          135deg,
          var(--sesc-orange) 0%,
          var(--sesc-orange-light) 100%
        );
        border-radius: 3px;
        margin: 2rem auto;
        position: relative;
        overflow: hidden;
        width: 150px;
      }

      .section-divider::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.8),
          transparent
        );
        animation: dividerShimmer 3s infinite;
      }

      @keyframes dividerShimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      .modern-button {
        background: linear-gradient(
          135deg,
          var(--sesc-orange) 0%,
          var(--sesc-orange-light) 100%
        );
        border: none;
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        border-radius: 1.5rem;
        padding: 1rem 2rem;
        font-size: 1.1rem;
        box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
      }

      .modern-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .modern-button:hover::before {
        left: 100%;
      }

      .modern-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(255, 107, 53, 0.5);
      }

      .filter-btn {
        position: relative;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        color: white;
        border-radius: 1.5rem;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .filter-btn.active {
        background: linear-gradient(
          135deg,
          var(--sesc-orange) 0%,
          var(--sesc-orange-light) 100%
        );
        color: white;
        box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        border-color: var(--sesc-orange);
      }

      .filter-btn:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.2);
      }

      .filter-btn.active:hover {
        background: linear-gradient(
          135deg,
          var(--sesc-orange-light) 0%,
          var(--sesc-orange) 100%
        );
      }

      .menu-container {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-radius: 2rem;
        padding: 2rem;
        margin: 2rem 0;
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .hero-section {
        background: var(--sesc-glass);
        border-radius: 2rem;
        margin-bottom: 3rem;
        overflow: hidden;
        position: relative;
        padding: 3rem 0;
      }

      .hero-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="25" cy="25" r="0.3" fill="rgba(255,255,255,0.05)"/><circle cx="75" cy="75" r="0.4" fill="rgba(255,255,255,0.08)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        opacity: 0.3;
        pointer-events: none;
      }

      .chef-hat-icon {
        font-size: 3rem;
        color: var(--sesc-orange);
        margin-bottom: 1rem;
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
      }

      .status-indicator {
        position: absolute;
        top: 1rem;
        right: 1rem;
        width: 12px;
        height: 12px;
        background: var(--sesc-orange);
        border-radius: 50%;
        animation: statusPulse 2s infinite;
      }

      @keyframes statusPulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.5;
          transform: scale(1.2);
        }
      }

      .scroll-fade {
        opacity: 0;
        transform: translateY(50px);
        transition: all 0.8s ease-out;
      }

      .scroll-fade.visible {
        opacity: 1;
        transform: translateY(0);
      }

      .luxury-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 25px 45px var(--shadow-color);
        border-radius: 2rem;
        color: var(--sesc-green-dark);
      }

      .sesc-logo {
        font-size: 2rem;
        font-weight: 800;
        color: white;
        letter-spacing: 0.1em;
      }

      .wave-decoration {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 80px;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="%23f4e7d1"></path><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="%23f4e7d1"></path><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%23f4e7d1"></path></svg>')
          center bottom/cover no-repeat;
        pointer-events: none;
      }

      @media (max-width: 768px) {
        .cardapio-title {
          font-size: 2.5rem;
        }

        .proteina-img {
          height: 200px;
        }

        .menu-container {
          padding: 1rem;
          margin: 1rem 0;
        }

        .hero-section {
          margin-bottom: 1.5rem;
          padding: 2rem 0;
        }

        .do-dia-badge {
          font-size: 1.2rem;
          padding: 0.4rem 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header Hero Section -->
    <div class="hero-section sesc-glass relative">
      <div class="container mx-auto px-6 text-center text-white relative z-10">
        <div class="floating">
          <i class="fas fa-chef-hat chef-hat-icon"></i>
        </div>
        <h1 class="cardapio-title bounce-in">Cardápio</h1>
        <div class="do-dia-badge fade-in">DO DIA</div>
        <div
          class="sesc-card rounded-2xl p-6 inline-block fade-in max-w-md mx-auto"
        >
          <p class="text-xl font-semibold mb-3 text-gray-800">
            <i class="fas fa-calendar-day mr-3 text-orange-500"></i>
            Hoje é
            <span id="currentDate" class="font-bold text-green-700"></span>
          </p>
          <div class="flex items-center justify-center">
            <div class="status-indicator"></div>
            <div class="ml-4 flex items-center text-gray-700">
              <i class="fas fa-clock mr-2"></i>
              <span class="font-semibold">
                <span class="sesc-orange-bg px-3 py-1 rounded-lg text-white"
                  >11h30 às 13h30</span
                >
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="wave-decoration"></div>
    </div>

    <div class="container mx-auto px-4 pb-8">
      <!-- Loading State -->
      <div id="loadingState" class="text-center py-16">
        <div class="sesc-glass rounded-3xl p-12 inline-block">
          <div class="relative mb-6">
            <div
              class="w-20 h-20 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto"
            ></div>
            <div
              class="absolute inset-0 w-20 h-20 border-4 border-transparent border-t-orange-400 rounded-full animate-spin mx-auto"
              style="animation-delay: -0.5s"
            ></div>
          </div>
          <p class="text-white text-xl font-medium">
            Carregando cardápio delicioso<span class="loading-dots"></span>
          </p>
        </div>
      </div>

      <!-- Error State -->
      <div id="errorState" class="hidden text-center py-16">
        <div class="sesc-glass rounded-3xl p-8 inline-block border-red-300">
          <i class="fas fa-exclamation-triangle text-red-400 text-4xl mb-4"></i>
          <p class="text-white text-xl font-medium">
            Erro ao carregar o cardápio. Tente novamente mais tarde.
          </p>
        </div>
      </div>

      <!-- Main Content -->
      <div id="mainContent" class="hidden">
        <!-- Almoço do Dia -->
        <section class="mb-16">
          <div class="menu-container">
            <div class="text-center mb-12">
              <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">
                <i
                  class="fas fa-bowl-food mr-4"
                  style="color: var(--sesc-orange)"
                ></i>
                ALMOÇO
              </h2>
              <div class="section-divider"></div>
              <p class="text-lg text-gray-200 font-medium">
                Pratos principais preparados com carinho
              </p>
            </div>

            <!-- Date Controls -->
            <div
              class="flex flex-col md:flex-row items-center justify-center gap-6 mb-12"
            >
              <div class="sesc-glass rounded-2xl p-4">
                <input
                  type="date"
                  id="datePicker"
                  class="bg-transparent text-white text-lg font-medium focus:outline-none focus:ring-2 focus:ring-orange-400 rounded-lg px-4 py-2"
                />
              </div>
              <button id="weekBtn" class="modern-button shadow-lg">
                <i class="fas fa-calendar-week mr-3"></i>Ver Semana Completa
              </button>
            </div>

            <div id="almocoContent" class="space-y-8">
              <!-- Almoço cards will be inserted here -->
            </div>

            <div id="noAlmocoMessage" class="hidden text-center py-16">
              <div class="sesc-glass rounded-3xl p-8 inline-block">
                <i class="fas fa-info-circle text-yellow-400 text-4xl mb-4"></i>
                <p class="text-white text-xl font-medium">
                  Almoço não disponível para esta data
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Lanches do Dia -->
        <section class="mb-16">
          <div class="menu-container">
            <div class="text-center mb-12">
              <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">
                <i
                  class="fas fa-cookie-bite mr-4"
                  style="color: var(--sesc-orange)"
                ></i>
                LANCHES
              </h2>
              <div class="section-divider"></div>
              <p class="text-lg text-gray-200 font-medium">
                Deliciosos lanches para o seu dia
              </p>
            </div>

            <!-- Filter Buttons -->
            <div
              id="filterButtons"
              class="flex flex-wrap justify-center gap-4 mb-12"
            >
              <button class="filter-btn active" data-filter="all">
                <i class="fas fa-th-large mr-3"></i>Todos os Lanches
              </button>
            </div>

            <div id="lanchesContent" class="space-y-12">
              <!-- Lanches sections will be inserted here -->
            </div>

            <div id="noLanchesMessage" class="hidden text-center py-16">
              <div class="sesc-glass rounded-3xl p-8 inline-block">
                <i class="fas fa-info-circle text-blue-400 text-4xl mb-4"></i>
                <p class="text-white text-xl font-medium">
                  Nenhum lanche disponível hoje
                </p>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- Footer -->
    <footer class="sesc-glass mt-20 relative">
      <div class="container mx-auto px-6 py-12 text-center text-white">
        <div class="mb-6">
          <i class="fas fa-heart text-red-400 text-2xl mr-3 floating"></i>
          <span class="text-xl font-medium">Feito com carinho para você</span>
        </div>
        <div class="sesc-logo mb-4">SESC</div>
        <p class="text-lg opacity-80 mb-6">Serviço Social do Comércio</p>
        <div class="sesc-beige-bg rounded-xl p-4 inline-block">
          <p class="text-sm font-semibold mb-2">
            <i class="fas fa-map-marker-alt mr-2"></i>
            Restaurante Sesc Centro
          </p>
          <p class="text-sm">Rua Doutor Araújo Filho, 947 - Centro</p>
        </div>
        <div class="mt-6 text-sm opacity-60">
          <i class="fas fa-sync-alt mr-2"></i>
          Atualizado automaticamente • <span id="lastUpdate"></span>
        </div>
      </div>
    </footer>

    <script>
      // Configuration
      const SHEET_ID = "1IhNTuKhJVGSxE8jgTJZR3dXQloRFE2DC3T-B9Y9vhP4";
      const BASE_URL = "https://opensheet.elk.sh";

      // Global state
      let almocoData = [];
      let lanchesData = [];
      let currentFilter = "all";
      let selectedDate = getTodayString();
      let showWeek = false;

      // Scroll Animation Observer
      const observerOptions = {
        threshold: 0.1,
        rootMargin: "0px 0px -50px 0px",
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
          }
        });
      }, observerOptions);

      // Utility functions
      function getWeekDates(dateStr) {
        const d = new Date(dateStr);
        const day = d.getDay();
        const monday = new Date(d);
        monday.setDate(d.getDate() - ((day + 6) % 7));
        const week = [];
        for (let i = 0; i < 6; i++) {
          const wd = new Date(monday);
          wd.setDate(monday.getDate() + i);
          week.push(wd.toISOString().slice(0, 10));
        }
        return week;
      }

      function formatDate(date) {
        return date.toLocaleDateString("pt-BR", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });
      }

      function formatPrice(price) {
        if (typeof price === "string" && price.trim() !== "" && !isNaN(price.replace(",", "."))) {
          // Aceita preço com vírgula ou ponto
          const numPrice = parseFloat(price.replace(",", "."));
          return `R$ ${numPrice.toFixed(2).replace(".", ",")}`;
        }
        if (typeof price === "string" && price.trim() !== "") {
          // Se vier texto (ex: "Grátis", "A consultar"), mostra o texto original
          return price;
        }
        return "-";
      }

      function getTodayString() {
        return new Date().toISOString().split("T")[0];
      }

      function createImageElement(src, alt, className = "") {
        if (!src || src.trim() === "") return "";
        return `<img src="${src}" alt="${alt}" class="proteina-img ${className}" onerror="this.style.display='none'" loading="lazy">`;
      }

      function getTypeIcon(type) {
        const icons = {
          Salgado: "fas fa-hamburger",
          Suco: "fas fa-glass-whiskey",
          Refrigerante: "fas fa-bottle-droplet",
          Sobremesa: "fas fa-ice-cream",
          Bebida: "fas fa-mug-hot",
          Lanche: "fas fa-sandwich",
        };
        return icons[type] || "fas fa-utensils";
      }

      // Data fetching functions
      async function fetchData(sheetName) {
        try {
          const response = await fetch(`${BASE_URL}/${SHEET_ID}/${sheetName}`);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          console.log(`${sheetName} data:`, data);
          return data;
        } catch (error) {
          console.error(`Error fetching ${sheetName}:`, error);
          throw error;
        }
      }

      // Rendering functions
      function showState(state) {
        document.getElementById("loadingState").style.display =
          state === "loading" ? "block" : "none";
        document
          .getElementById("errorState")
          .classList.toggle("hidden", state !== "error");
        document
          .getElementById("mainContent")
          .classList.toggle("hidden", state !== "main");
        document
          .getElementById("noAlmocoMessage")
          .classList.toggle("hidden", state !== "noAlmoco");
        document
          .getElementById("noLanchesMessage")
          .classList.toggle("hidden", state !== "noLanches");
      }

      function renderAlmoco() {
        const almocoContainer = document.getElementById("almocoContent");
        let almocoList = [];

        if (showWeek) {
          const weekDates = getWeekDates(selectedDate);
          almocoList = almocoData.filter(
            (item) =>
              weekDates.includes(item.Data) &&
              item.Status &&
              item.Status.toLowerCase() === "ativo"
          );
        } else {
          const almoco = almocoData.find(
            (item) =>
              item.Data === selectedDate &&
              item.Status &&
              item.Status.toLowerCase() === "ativo"
          );
          if (almoco) almocoList = [almoco];
        }

        if (!almocoList.length) {
          almocoContainer.innerHTML = "";
          showState("noAlmoco");
          return;
        }

        showState("main");
        almocoContainer.innerHTML = almocoList
          .map((todayAlmoco, index) => {
            const img1 = todayAlmoco["Imagem Proteína 1"] || "";
            const img2 = todayAlmoco["Imagem Proteína 2"] || "";
            const prot1 = todayAlmoco["Proteína 1"] || "";
            const prot2 = todayAlmoco["Proteína 2"] || "";
            const acompanhamentos = todayAlmoco.Acompanhamentos
              ? todayAlmoco.Acompanhamentos.split(",").map((a) => a.trim())
              : [];
            const saladas = todayAlmoco.Saladas
              ? todayAlmoco.Saladas.split(",").map((s) => s.trim())
              : [];
            const dataFormatada = todayAlmoco.Data
              ? new Date(todayAlmoco.Data + "T00:00:00").toLocaleDateString(
                  "pt-BR",
                  {
                    weekday: "long",
                    day: "2-digit",
                    month: "2-digit",
                  }
                )
              : "";

            return `
              <div class="scroll-fade" style="animation-delay: ${index * 0.1}s">
                <div class="sesc-card p-8 mb-8 card-hover">
                  <div class="text-center mb-8">
                    <div class="sesc-orange-bg rounded-xl p-4 inline-block mb-4">
                      <h3 class="text-2xl font-bold text-white">${dataFormatada}</h3>
                    </div>
                  </div>
                  
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="sesc-beige-bg rounded-3xl p-8 card-hover text-center">
                      ${
                        img1
                          ? createImageElement(img1, prot1)
                          : `
                        <div class="w-full h-64 sesc-green-bg rounded-2xl mb-6 flex items-center justify-center">
                          <i class="fas fa-drumstick-bite text-6xl text-white opacity-50"></i>
                        </div>
                      `
                      }
                      <h4 class="text-xl font-bold" style="color: var(--sesc-green-dark)">${prot1}</h4>
                    </div>
                    
                    <div class="sesc-beige-bg rounded-3xl p-8 card-hover text-center">
                      ${
                        img2
                          ? createImageElement(img2, prot2)
                          : `
                        <div class="w-full h-64 sesc-green-bg rounded-2xl mb-6 flex items-center justify-center">
                          <i class="fas fa-fish text-6xl text-white opacity-50"></i>
                        </div>
                      `
                      }
                      <h4 class="text-xl font-bold" style="color: var(--sesc-green-dark)">${prot2}</h4>
                    </div>
                  </div>

                  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="sesc-beige-bg rounded-3xl p-8">
                      <div class="flex items-center mb-6">
                        <div class="w-16 h-16 sesc-orange-bg rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                          <i class="fas fa-bowl-rice text-white text-2xl"></i>
                        </div>
                        <h4 class="text-2xl font-bold" style="color: var(--sesc-green-dark)">Acompanhamentos</h4>
                      </div>
                      <div class="space-y-3">
                        ${acompanhamentos
                          .map(
                            (a) => `
                          <div class="flex items-center">
                            <div class="w-3 h-3 rounded-full mr-3 sesc-orange-bg"></div>
                            <span class="font-medium" style="color: var(--sesc-green-dark)">${a}</span>
                          </div>
                        `
                          )
                          .join("")}
                      </div>
                    </div>

                    <div class="sesc-beige-bg rounded-3xl p-8">
                      <div class="flex items-center mb-6">
                        <div class="w-16 h-16 sesc-green-bg rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                          <i class="fas fa-leaf text-white text-2xl"></i>
                        </div>
                        <h4 class="text-2xl font-bold" style="color: var(--sesc-green-dark)">Saladas</h4>
                      </div>
                      <div class="space-y-3">
                        ${saladas
                          .map(
                            (s) => `
                          <div class="flex items-center">
                            <div class="w-3 h-3 rounded-full mr-3 sesc-green-bg"></div>
                            <span class="font-medium" style="color: var(--sesc-green-dark)">${s}</span>
                          </div>
                        `
                          )
                          .join("")}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            `;
          })
          .join("");

        // Add scroll animations
        document.querySelectorAll(".scroll-fade").forEach((el) => {
          observer.observe(el);
        });
      }

      function renderLanches() {
        const lanchesContainer = document.getElementById("lanchesContent");
        const noLanchesMessage = document.getElementById("noLanchesMessage");
        const filterButtons = document.getElementById("filterButtons");

        const activeLanches = lanchesData.filter(
          (item) => item.Status && item.Status.toLowerCase() === "ativo"
        );

        if (activeLanches.length === 0) {
          lanchesContainer.innerHTML = "";
          noLanchesMessage.classList.remove("hidden");
          filterButtons.innerHTML = `
            <button class="filter-btn active" data-filter="all">
              <i class="fas fa-th-large mr-3"></i>Todos os Lanches
            </button>
          `;
          return;
        }

        noLanchesMessage.classList.add("hidden");

        // Group by type
        const groupedLanches = activeLanches.reduce((acc, item) => {
          const type = item.Tipo || "Outros";
          if (!acc[type]) acc[type] = [];
          acc[type].push(item);
          return acc;
        }, {});

        // Create filter buttons
        const types = Object.keys(groupedLanches);
        filterButtons.innerHTML = `
          <button class="filter-btn active" data-filter="all">
            <i class="fas fa-th-large mr-3"></i>Todos os Lanches
          </button>
          ${types
            .map(
              (type) => `
              <button class="filter-btn hover:scale-105" data-filter="${type}">
                <i class="${getTypeIcon(type)} mr-3"></i>${type}
              </button>
            `
            )
            .join("")}
        `;

        // Render sections
        lanchesContainer.innerHTML = types
          .map(
            (type, sectionIndex) => `
            <div class="lanches-section scroll-fade" data-type="${type}" style="animation-delay: ${
              sectionIndex * 0.1
            }s">
              <div class="sesc-card p-8 mb-8 card-hover">
                <div class="flex items-center justify-between mb-8">
                  <div class="flex items-center">
                    <div class="w-20 h-20 sesc-orange-bg rounded-3xl flex items-center justify-center mr-6 shadow-xl">
                      <i class="${getTypeIcon(type)} text-3xl text-white"></i>
                    </div>
                    <div>
                      <h3 class="text-3xl font-bold" style="color: var(--sesc-green-dark)">${type}</h3>
                      <p class="text-gray-600 font-medium">Deliciosas opções para você</p>
                    </div>
                  </div>
                  <div class="category-badge text-white px-6 py-3 rounded-2xl text-lg font-bold shadow-lg">
                    ${groupedLanches[type].length} item${
              groupedLanches[type].length > 1 ? "s" : ""
            }
                  </div>
                </div>
                
                <div class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                  ${groupedLanches[type]
                    .map(
                      (item, itemIndex) => `
                      <div class="sesc-beige-bg rounded-3xl p-6 card-hover bounce-in relative" style="animation-delay: ${
                        sectionIndex * 0.1 + itemIndex * 0.05
                      }s">
                        ${
                          item.Imagem
                            ? createImageElement(item.Imagem, item.Nome, "h-48")
                            : `
                            <div class="w-full h-48 sesc-green-bg rounded-2xl mb-4 flex items-center justify-center shimmer">
                              <i class="${getTypeIcon(
                                type
                              )} text-6xl text-white opacity-50"></i>
                            </div>
                          `
                        }
                        <div class="text-center">
                          <h4 class="text-lg font-bold mb-4 leading-tight" style="color: var(--sesc-green-dark)">${
                            item.Nome
                          }</h4>
                          <div class="flex items-center justify-between">
                            <div class="price-tag">
                              ${formatPrice(item.Preço)}
                            </div>
                            <div class="w-12 h-12 sesc-green-bg rounded-2xl flex items-center justify-center">
                              <i class="${getTypeIcon(
                                type
                              )} text-xl text-white"></i>
                            </div>
                          </div>
                        </div>
                        <div class="absolute top-4 right-4 w-3 h-3 rounded-full pulse-glow sesc-orange-bg"></div>
                      </div>
                    `
                    )
                    .join("")}
                </div>
              </div>
            </div>
          `
          )
          .join("");

        // Add scroll animations
        document.querySelectorAll(".scroll-fade").forEach((el) => {
          observer.observe(el);
        });

        // Add filter functionality
        setupFilters();
      }

      function setupFilters() {
        const filterButtons = document.querySelectorAll(".filter-btn");
        const sections = document.querySelectorAll(".lanches-section");

        filterButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            const filter = btn.dataset.filter;

            // Update active button with smooth transition
            filterButtons.forEach((b) => {
              b.classList.remove("active");
            });

            btn.classList.add("active");

            // Show/hide sections with fade effect
            sections.forEach((section, index) => {
              if (filter === "all" || section.dataset.type === filter) {
                section.style.display = "block";
                section.style.opacity = "0";
                section.style.transform = "translateY(30px)";

                setTimeout(() => {
                  section.style.transition = "all 0.6s ease-out";
                  section.style.opacity = "1";
                  section.style.transform = "translateY(0)";
                }, index * 100);
              } else {
                section.style.transition = "all 0.3s ease-out";
                section.style.opacity = "0";
                section.style.transform = "translateY(-20px)";

                setTimeout(() => {
                  section.style.display = "none";
                }, 300);
              }
            });
          });
        });
      }

      // Main initialization
      async function init() {
        // Set current date with enhanced formatting
        const now = new Date();
        document.getElementById("currentDate").textContent = formatDate(now);

        try {
          // Show loading state
          showState("loading");

          // Fetch data with progress indication
          const [almocoResponse, lanchesResponse] = await Promise.all([
            fetchData("Almoco"),
            fetchData("Lanches"),
          ]);

          almocoData = almocoResponse;
          lanchesData = lanchesResponse;

          // Small delay for smooth transition
          setTimeout(() => {
            // Render content
            renderAlmoco();
            renderLanches();

            // Show main content with fade in
            showState("main");

            // Update last update time
            document.getElementById("lastUpdate").textContent =
              now.toLocaleTimeString("pt-BR");

            // Add entrance animations
            setTimeout(() => {
              document
                .querySelectorAll(".fade-in, .bounce-in")
                .forEach((el, index) => {
                  el.style.animationDelay = `${index * 0.1}s`;
                });
            }, 100);
          }, 800);
        } catch (error) {
          console.error("Error initializing app:", error);
          setTimeout(() => {
            showState("error");
          }, 1000);
        }
      }

      // Enhanced event listeners
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize date picker
        document.getElementById("datePicker").value = getTodayString();

        // Date picker event
        document
          .getElementById("datePicker")
          .addEventListener("change", (e) => {
            selectedDate = e.target.value;
            showWeek = false;

            // Add loading effect
            const almocoContainer = document.getElementById("almocoContent");
            almocoContainer.style.opacity = "0.5";
            almocoContainer.style.transform = "scale(0.95)";

            setTimeout(() => {
              renderAlmoco();
              almocoContainer.style.transition = "all 0.5s ease-out";
              almocoContainer.style.opacity = "1";
              almocoContainer.style.transform = "scale(1)";
            }, 200);
          });

        // Week button event
        document.getElementById("weekBtn").addEventListener("click", () => {
          if (document.getElementById("datePicker").value) {
            selectedDate = document.getElementById("datePicker").value;
            showWeek = true;

            // Add loading effect
            const almocoContainer = document.getElementById("almocoContent");
            almocoContainer.style.opacity = "0.5";
            almocoContainer.style.transform = "scale(0.95)";

            setTimeout(() => {
              renderAlmoco();
              almocoContainer.style.transition = "all 0.5s ease-out";
              almocoContainer.style.opacity = "1";
              almocoContainer.style.transform = "scale(1)";
            }, 200);
          }
        });

        // Initialize app
        init();
      });

      // Auto-refresh with visual feedback
      setInterval(() => {
        const lastUpdateEl = document.getElementById("lastUpdate");
        if (lastUpdateEl) {
          lastUpdateEl.style.opacity = "0.5";
          lastUpdateEl.innerHTML =
            '<i class="fas fa-sync-alt animate-spin mr-2"></i>Atualizando...';
        }

        setTimeout(() => {
          init();
        }, 1000);
      }, 30 * 60 * 1000);

      // Add smooth scrolling
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute("href"));
          if (target) {
            target.scrollIntoView({
              behavior: "smooth",
              block: "start",
            });
          }
        });
      });

      // Add resize handler for responsive animations
      let resizeTimeout;
      window.addEventListener("resize", () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          // Re-initialize animations on resize
          document.querySelectorAll(".scroll-fade").forEach((el) => {
            observer.observe(el);
          });
        }, 250);
      });
    </script>
  </body>
</html>
